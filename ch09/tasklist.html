<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="/fe21-javascript/ch09/TL.css" />
  </head>
  <body>
    <main>
      <h1>Task Manager</h1>
      <div id="tasks">
        <span id="name">&nbsp;</span>Tasks<br />
        <textarea id="task_list" rows="6" cols="50"></textarea>
      </div>

      <label for="task">Task</label><br />
      <input type="text" name="task" id="task" /><br />

      <input type="button" name="add_task" id="add_task" value="Add Task" />
      <input
        type="button"
        name="clear_tasks"
        id="clear_tasks"
        value="Clear Tasks"
      /><br />

      <input
        type="button"
        name="delete_task"
        id="delete_task"
        value="Delete Task"
      />
      <input
        type="button"
        name="toggle_sort"
        id="toggle_sort"
        value="Toggle Sort"
      /><br />

      <input type="button" name="set_name" id="set_name" value="Set Name" />
      <input
        type="button"
        name="filter_tasks"
        id="filter_tasks"
        value="Filter Tasks"
      /><br />
    </main>
    <script>
      "use strict";

      var $ = function (id) {
        return document.getElementById(id);
      };

      var tasks = [];
      // var sortDirection = 'ASC';

      var displayTaskList = function () {
        var list = "";

        if (tasks.length === 0) {
          var storage = localStorage.getItem("tasks") || "";

          if (storage.length > 0) {
            tasks = storage.split("|");
          }
        }

        if (tasks.length > 0) {
          tasks.sort();
          list = tasks.join("\n");
        }

        $("task_list").value = list;
        $("task").focus();
      };

      var addToTaskList = function () {
        var task = $("task");
        if (task.value === "") {
          alert("Please enter a task.");
        } else {
          tasks.push(task.value);
          localStorage.tasks = tasks.join("|");

          tasks.value = "";
          displayTaskList();
        }
      };

      var clearTaskList = function () {
        tasks.length = 0;
        localStorage.tasks = "";
        $("task_list").value = "";
        $("task").focus();
      };

      window.onload = function () {
        $("add_task").onclick = addToTaskList;
        $("clear_tasks").onclick = clearTaskList;
        displayTaskList();
      };
    </script>
  </body>
</html>
